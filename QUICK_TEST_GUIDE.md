# ‚ö°Ô∏è –ë—ã—Å—Ç—Ä—ã–π —á–µ–∫-–ª–∏—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

## üéØ 3 –≥–ª–∞–≤–Ω—ã—Ö —Ç–µ—Å—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

### ‚úÖ –¢–µ—Å—Ç 1: Veo —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ —ç–∫–æ–Ω–æ–º-—Ä–µ–∂–∏–º (2 –º–∏–Ω)

```bash
# –ß—Ç–æ –¥–µ–ª–∞—Ç—å:
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –≤ Telegram
2. –í—ã–±—Ä–∞—Ç—å: –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí üéû –°–æ–∑–¥–∞—Ç—å –≤–∏–¥–µ–æ ‚Üí üåä Veo 3.1
3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç: "beautiful sunset over ocean"

# –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç: "–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 4 —Å–µ–∫"
‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç: "–°—Ç–æ–∏–º–æ—Å—Ç—å: ~160,000 —Ç–æ–∫–µ–Ω–æ–≤"
‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ
‚úÖ –í–∏–¥–µ–æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é ~4 —Å–µ–∫—É–Ω–¥—ã (–∞ –Ω–µ 8!)

# –í –ª–æ–≥–∞—Ö:
grep "veo_cost_calculated" logs/*.log | tail -1 | jq .
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# duration: 4
# total_tokens: 160000
# estimated_cost_usd: 1.6
```

### ‚úÖ –¢–µ—Å—Ç 2: –§–∏–∫—Å –æ—à–∏–±–∫–∏ —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º —Ñ–æ—Ç–æ (3 –º–∏–Ω)

```bash
# –ß—Ç–æ –¥–µ–ª–∞—Ç—å:
1. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª—é–±–æ–µ —Ñ–æ—Ç–æ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω
2. –í—ã–±—Ä–∞—Ç—å: üéû –°–æ–∑–¥–∞—Ç—å –≤–∏–¥–µ–æ ‚Üí üåä Veo 3.1
3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ —Å –ø–æ–¥–ø–∏—Å—å—é: "animate this"
4. –î–æ–∂–¥–∞—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
5. –ü–û–í–¢–û–†–ò–¢–¨ —à–∞–≥–∏ 2-4 —Å –¢–ï–ú –ñ–ï –§–û–¢–û

# –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
‚úÖ –û–±–∞ —Ä–∞–∑–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ë–ï–ó –æ—à–∏–±–æ–∫
‚úÖ –ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–µ
‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞ –≤ –æ–±–æ–∏—Ö —Å–ª—É—á–∞—è—Ö

# –í —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ:
ls -la storage/temp/
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
‚úÖ –ù–ï–¢ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤
‚úÖ –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ (—Å UUID –∏ timestamp)
# –§–æ—Ä–º–∞—Ç: video_input_u12345_1703001234_a1b2c3d4e5f6.jpg
```

### ‚úÖ –¢–µ—Å—Ç 3: Rate limiting (3 –º–∏–Ω)

```bash
# –ß—Ç–æ –¥–µ–ª–∞—Ç—å:
1. –ó–∞–ø—Ä–æ—Å–∏—Ç—å Veo –≤–∏–¥–µ–æ: "cat playing"
2. –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (2-5 –º–∏–Ω)
3. –°—Ä–∞–∑—É –∑–∞–ø—Ä–æ—Å–∏—Ç—å –≤—Ç–æ—Ä–æ–µ: "dog running"
4. –î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
5. –°—Ä–∞–∑—É –∑–∞–ø—Ä–æ—Å–∏—Ç—å —Ç—Ä–µ—Ç—å–µ: "bird flying"

# –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ 3-–º –∑–∞–ø—Ä–æ—Å–µ:
‚úÖ –ü–æ—è–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ: "–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è Veo 3.1"
‚úÖ –£–∫–∞–∑–∞–Ω–æ: "–õ–∏–º–∏—Ç: 2 –∑–∞–ø—Ä–æ—Å–∞ –≤ —á–∞—Å"
‚úÖ –ü–æ–∫–∞–∑–∞–Ω–æ –≤—Ä–µ–º—è –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

# –í –ª–æ–≥–∞—Ö:
grep "rate_limit" logs/*.log | tail -5
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–±—ã—Ç–∏–µ —Å user_id
```

---

## üìã –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –¢–µ—Å—Ç 4: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤

```bash
# –í –ª–æ–≥–∞—Ö –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
grep "generation_logged" logs/*.log | tail -1 | jq .

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª–µ–π:
‚úÖ user_id
‚úÖ model: "veo-3.1"
‚úÖ estimated_tokens: 160000
‚úÖ actual_tokens: 160000
‚úÖ estimated_cost_usd: 1.6
‚úÖ actual_cost_usd: 1.6
‚úÖ duration_seconds: 4
‚úÖ status: "success"
```

### –¢–µ—Å—Ç 5: –û—á–∏—Å—Ç–∫–∞ temp —Ñ–∞–π–ª–æ–≤

```bash
# –î–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
ls storage/temp/ | wc -l
# –ó–∞–ø–∏—Å–∞—Ç—å —á–∏—Å–ª–æ

# –ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
ls storage/temp/ | wc -l
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫–æ–µ –∂–µ (¬±1-2)

# –ù–µ –¥–æ–ª–∂–Ω–æ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å—Å—è!
```

---

## üö® –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ —Ç–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è

### –¢–µ—Å—Ç 1 –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
1. –§–∞–π–ª app/services/video/veo_service.py –∏–∑–º–µ–Ω—ë–Ω?
   git diff app/services/video/veo_service.py

2. –§–∞–π–ª app/core/cost_guard.py —Å—É—â–µ—Å—Ç–≤—É–µ—Ç?
   ls -la app/core/cost_guard.py

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞:
   # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä/–ø—Ä–æ—Ü–µ—Å—Å
```

### –¢–µ—Å—Ç 2 –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è (–æ—à–∏–±–∫–∞ —Å —Ñ–æ—Ç–æ)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
1. –§–∞–π–ª app/core/temp_files.py —Å—É—â–µ—Å—Ç–≤—É–µ—Ç?
   ls -la app/core/temp_files.py

2. media_handler.py –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç temp_files?
   grep "from app.core.temp_files import" app/bot/handlers/media_handler.py

3. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—à–∏–±–∫—É –≤ –ª–æ–≥–∞—Ö:
   tail -100 logs/*.log | grep -A5 "ERROR"
```

### –¢–µ—Å—Ç 3 –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è (–Ω–µ—Ç rate limiting)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis:
1. Redis –∑–∞–ø—É—â–µ–Ω?
   redis-cli ping
   # –î–æ–ª–∂–Ω–æ: PONG

2. cost_guard –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Redis?
   grep "redis_client" app/core/cost_guard.py

3. –ï—Å–ª–∏ Redis –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, rate limiting –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å!
```

---

## üìä –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ production

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```bash
# 1. –°—Ä–µ–¥–Ω—è—è —Å—Ç–æ–∏–º–æ—Å—Ç—å Veo –∑–∞–ø—Ä–æ—Å–∞ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å ~160k —Ç–æ–∫–µ–Ω–æ–≤):
grep "veo_cost_calculated" logs/*.log | \
  jq -s 'map(.total_tokens) | add / length'
# –û–∂–∏–¥–∞–µ–º–æ–µ: 160000

# 2. –°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å ~4 —Å–µ–∫):
grep "veo_cost_calculated" logs/*.log | \
  jq -s 'map(.duration) | add / length'
# –û–∂–∏–¥–∞–µ–º–æ–µ: 4

# 3. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö rate limit:
grep "rate.*exceeded" logs/*.log | wc -l

# 4. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö vs –æ—à–∏–±–æ—á–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π:
grep "generation_logged.*success" logs/*.log | wc -l
grep "generation_logged.*error" logs/*.log | wc -l
```

### –ê–ª–µ—Ä—Ç—ã (–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å)

```bash
# –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:

# 1. –î–Ω–µ–≤–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å > $100
# 2. –û–¥–∏–Ω–æ—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å > $5 (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ!)
# 3. Rate limit —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç > 50 —Ä–∞–∑/—á–∞—Å
# 4. –û—à–∏–±–æ–∫ > 10% –æ—Ç –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
```

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –µ—Å–ª–∏:

- ‚úÖ Veo –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 4-—Å–µ–∫—É–Ω–¥–Ω—ã–µ –≤–∏–¥–µ–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ –°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ ~160,000 —Ç–æ–∫–µ–Ω–æ–≤ (–Ω–µ 15,000!)
- ‚úÖ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≥–æ –∂–µ —Ñ–æ—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ Rate limiting –±–ª–æ–∫–∏—Ä—É–µ—Ç 3-–π –∑–∞–ø—Ä–æ—Å –≤ —á–∞—Å
- ‚úÖ –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –≤ storage/temp/
- ‚úÖ –õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞—Å—Ö–æ–¥–∞—Ö

**–ï—Å–ª–∏ –≤—Å–µ 6 –ø—É–Ω–∫—Ç–æ–≤ ‚úÖ - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç–ª–∏—á–Ω–æ!**

---

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `tail -100 logs/*.log`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Git –∏–∑–º–µ–Ω–µ–Ω–∏—è: `git diff`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –Ω–∞ –º–µ—Å—Ç–µ:
   - `app/core/cost_guard.py`
   - `app/core/temp_files.py`
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis: `redis-cli ping`

**–£–¥–∞—á–∏! üöÄ**
